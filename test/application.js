module('swlcalc');

test('should initate swlcalc submodules', 8, function() {
    swlcalc.init();
    ok(swlcalc);
    ok(swlcalc.data);
    ok(swlcalc.button);
    ok(swlcalc.select);
    ok(swlcalc.buttonBar);
    ok(swlcalc.summary);
    ok(swlcalc.export);
    ok(swlcalc.import);
});

//TODO/TEST : to add assertions for signet text when implemented
test('should import from hash', 182, function() {
    location.hash = 'weapon=3,4,3,19,3,2,2,13,0,4,0&weapon2=3,7,2,29,4,3,1,15,0,8,0&head=3,4,2,24,4,3,2,18,1,1,16&finger=2,2,1,20,5,4,3,15,4,1,2&neck=1,11,3,6,3,2,1,20,1,1,3&wrist=5,2,2,68,3,3,2,6,5,1,8&luck=1,1,1,10,2,2,1,18,3,1,13&waist=5,11,1,2,4,5,3,8,3,1,16&occult=1,7,3,19,5,1,3,2,2,1,10'
    swlcalc.init();

    // Summary
    equal($('#stat-ilvl').html(), '538');
    equal($('#stat-power-rating').html(), '4388');
    equal($('#stat-weapon-power').html(), '1577');
    equal($('#stat-attack-rating').html(), '8710');
    equal($('#stat-heal-rating').html(), '4310');
    equal($('#stat-hitpoints').html(), '7512');
    equal($('#stat-combat-power').html(), '772');
    equal($('#stat-healing-power').html(), '442');
    equal($('#stat-critical-rating').html(), '+1598');
    equal($('#stat-critical-chance').html(), '18.6%');
    equal($('#stat-critical-power').html(), '+1858');
    equal($('#stat-critical-power-percentage').html(), '120.6%');
    equal($('#stat-hit-rating').html(), '+1539');
    equal($('#stat-glance-reduction').html(), '30.3%');
    equal($('#stat-defense-rating').html(), '+1313');
    equal($('#stat-glance-chance').html(), '12.9%');
    equal($('#stat-evade-rating').html(), '+1805');
    equal($('#stat-evade-chance').html(), '12.4%');
    // equal($('#stat-physical-protection').html(), '+660');
    // equal($('#stat-magical-protection').html(), '+300');

    ok($('#weapon-slot').is(':visible'));
    equal($('#weapon-total-ilvl').html(), '400');
    equal($('#weapon-name').html(), ': Blood');
    equal($('#weapon-wtype').val(), 'blood');
    equal($('#weapon-rarity').val(), 'epic');
    equal($('#weapon-quality').val(), 'mkIII');
    equal($('#weapon-level').val(), '19');
    equal($('#weapon-power-rating').html(), '+1577');
    equal($('#weapon-ilvl').html(), '264');
    equal($('#weapon-glyph').val(), 'critical-rating');
    equal($('#weapon-glyph-rarity').val(), 'epic');
    equal($('#weapon-glyph-quality').val(), 'simple');
    equal($('#weapon-glyph-level').val(), '13');
    equal($('#weapon-glyph-rating').html(), '+329');
    equal($('#weapon-glyph-ilvl').html(), '136');
    equal($('#weapon-signet').val(), '4');
    equal($('#weapon-signet-rarity').val(), undefined);
    equal($('#weapon-signet-level').val(), undefined);
    equal($('#weapon-signet-ilvl').html(), undefined);

    ok(!$('#weapon2-slot').is(':visible'));
    equal($('#weapon2-total-ilvl').html(), '581');
    equal($('#weapon2-name').html(), ': Shotgun');
    equal($('#weapon2-wtype').val(), 'shotgun');
    equal($('#weapon2-rarity').val(), 'epic');
    equal($('#weapon2-quality').val(), 'mkII');
    equal($('#weapon2-level').val(), '29');
    equal($('#weapon2-power-rating').html(), '+1809');
    equal($('#weapon2-ilvl').html(), '315');
    equal($('#weapon2-glyph').val(), 'critical-power');
    equal($('#weapon2-glyph-rarity').val(), 'mythic');
    equal($('#weapon2-glyph-quality').val(), 'crude');
    equal($('#weapon2-glyph-level').val(), '15');
    equal($('#weapon2-glyph-rating').html(), '+491');
    equal($('#weapon2-glyph-ilvl').html(), '266');
    equal($('#weapon2-signet').val(), '8');
    equal($('#weapon2-signet-rarity').val(), undefined);
    equal($('#weapon2-signet-level').val(), undefined);
    equal($('#weapon2-signet-ilvl').html(), undefined);

    equal($('#head-total-ilvl').html(), '487');
    equal($('#head-itemId').val(), '4');
    equal($('#head-rarity').val(), 'epic');
    equal($('#head-quality').val(), 'luminous');
    equal($('#head-level').val(), '24');
    equal($('#head-power-rating').html(), '+1113');
    equal($('#head-ilvl').html(), '252');
    equal($('#head-description').html(), 'Whenever you hit the same enemy 3 times in succession, you deal <span id="head-bonus" class="bonus-var-attack">290</span> physical damage.');
    equal($('#head-glyph').val(), 'critical-power');
    equal($('#head-glyph-rarity').val(), 'mythic');
    equal($('#head-glyph-quality').val(), 'simple');
    equal($('#head-glyph-level').val(), '18');
    equal($('#head-glyph-rating').html(), '+580');
    equal($('#head-glyph-ilvl').html(), '226');
    equal($('#head-signet').val(), '1');
    equal($('#head-signet-rarity').val(), 'standard');
    equal($('#head-signet-level').val(), '16');
    equal($('#head-signet-ilvl').html(), '10');

    equal($('#finger-total-ilvl').html(), '571');
    equal($('#finger-itemId').val(), '2');
    equal($('#finger-rarity').val(), 'superior');
    equal($('#finger-quality').val(), 'faded');
    equal($('#finger-level').val(), '20');
    equal($('#finger-power-rating').html(), '+314');
    equal($('#finger-ilvl').html(), '113');
    equal($('#finger-description').html(), 'Whenever you purge a beneficial effect from an enemy\'s ability, your Protection is increased by <span class="bonus-const">1530</span> for 4 seconds.');  
    equal($('#finger-glyph').val(), 'evade-rating');
    equal($('#finger-glyph-rarity').val(), 'legendary');
    equal($('#finger-glyph-quality').val(), 'intricate');
    equal($('#finger-glyph-level').val(), '15');
    equal($('#finger-glyph-rating').html(), '+1052');
    equal($('#finger-glyph-ilvl').html(), '369');
    equal($('#finger-signet').val(), '1');
    equal($('#finger-signet-rarity').val(), 'mythic');
    equal($('#finger-signet-level').val(), '2');
    equal($('#finger-signet-ilvl').html(), '89');

    equal($('#neck-total-ilvl').html(), '143');
    equal($('#neck-itemId').val(), '11');
    equal($('#neck-rarity').val(), 'standard');
    equal($('#neck-quality').val(), 'radiant');
    equal($('#neck-level').val(), '6');
    equal($('#neck-power-rating').html(), '+70');
    equal($('#neck-ilvl').html(), '13');
    equal($('#neck-description').html(), 'This talisman gains more health when leveling up.<br>Whenever you lose health while below 50% of your maximum health, your damage is increased by 17% for 3 seconds and your next attack during this time will restore 4% of your maximum health. This effect can only occur once every 10 seconds.');
    equal($('#neck-glyph').val(), 'critical-rating');
    equal($('#neck-glyph-rarity').val(), 'epic');
    equal($('#neck-glyph-quality').val(), 'crude');
    equal($('#neck-glyph-level').val(), '20');
    equal($('#neck-glyph-rating').html(), '+339');
    equal($('#neck-glyph-ilvl').html(), '128');
    equal($('#neck-signet').val(), '1');
    equal($('#neck-signet-rarity').val(), 'standard');
    equal($('#neck-signet-level').val(), '3');
    equal($('#neck-signet-ilvl').html(), '2');

    equal($('#wrist-total-ilvl').html(), '1292');
    equal($('#wrist-itemId').val(), '2');
    equal($('#wrist-rarity').val(), 'legendary');
    equal($('#wrist-quality').val(), 'luminous');
    equal($('#wrist-level').val(), '68');
    equal($('#wrist-power-rating').html(), '+1951');
    equal($('#wrist-ilvl').html(), '1026');
    equal($('#wrist-description').html(), 'Whenever you heal an ally who does not have any active detrimental effects, you have a 25% chance to restore <span id="wrist-bonus" class="bonus-var-heal">221</span> health to that ally.');
    equal($('#wrist-glyph').val(), 'critical-power');
    equal($('#wrist-glyph-rarity').val(), 'epic');
    equal($('#wrist-glyph-quality').val(), 'simple');
    equal($('#wrist-glyph-level').val(), '6');
    equal($('#wrist-glyph-rating').html(), '+270');
    equal($('#wrist-glyph-ilvl').html(), '94');
    equal($('#wrist-signet').val(), '1');
    equal($('#wrist-signet-rarity').val(), 'legendary');
    equal($('#wrist-signet-level').val(), '8');
    equal($('#wrist-signet-ilvl').html(), '172');

    equal($('#luck-total-ilvl').html(), '136');
    equal($('#luck-itemId').val(), '1');
    equal($('#luck-rarity').val(), 'standard');
    equal($('#luck-quality').val(), 'faded');
    equal($('#luck-level').val(), '10');
    equal($('#luck-power-rating').html(), '+53');
    equal($('#luck-ilvl').html(), '22');
    equal($('#luck-description').html(), '');
    equal($('#luck-glyph').val(), 'critical-rating');
    equal($('#luck-glyph-rarity').val(), 'superior');
    equal($('#luck-glyph-quality').val(), 'crude');
    equal($('#luck-glyph-level').val(), '18');
    equal($('#luck-glyph-rating').html(), '+174');
    equal($('#luck-glyph-ilvl').html(), '58');
    equal($('#luck-signet').val(), '1');
    equal($('#luck-signet-rarity').val(), 'epic');
    equal($('#luck-signet-level').val(), '13');
    equal($('#luck-signet-ilvl').html(), '55');

    equal($('#waist-total-ilvl').html(), '846');
    equal($('#waist-itemId').val(), '11');
    equal($('#waist-rarity').val(), 'legendary');
    equal($('#waist-quality').val(), 'faded');
    equal($('#waist-level').val(), '2');
    equal($('#waist-power-rating').html(), '+775');
    equal($('#waist-ilvl').html(), '591');
    equal($('#waist-description').html(), 'Whenever you spend Rage to empower an attack, you gain 7 Rage. Rage must be spent in order to trigger this effect.');
    equal($('#waist-glyph').val(), 'defense-rating');
    equal($('#waist-glyph-rarity').val(), 'mythic');
    equal($('#waist-glyph-quality').val(), 'intricate');
    equal($('#waist-glyph-level').val(), '8');
    equal($('#waist-glyph-rating').html(), '+560');
    equal($('#waist-glyph-ilvl').html(), '196');
    equal($('#waist-signet').val(), '1');
    equal($('#waist-signet-rarity').val(), 'epic');
    equal($('#waist-signet-level').val(), '16');
    equal($('#waist-signet-ilvl').html(), '59');

    equal($('#occult-total-ilvl').html(), '386');
    equal($('#occult-itemId').val(), '7');
    equal($('#occult-rarity').val(), 'standard');
    equal($('#occult-quality').val(), 'radiant');
    equal($('#occult-level').val(), '19');
    equal($('#occult-power-rating').html(), '+112');
    equal($('#occult-ilvl').html(), '42');
    equal($('#occult-description').html(), 'Whenever you or any of your group members defeat an enemy, your Protection is increased by <span class="bonus-const">2045</span> for 5 seconds.');
    equal($('#occult-glyph').val(), 'hit-rating');
    equal($('#occult-glyph-rarity').val(), 'legendary');
    equal($('#occult-glyph-quality').val(), 'intricate');
    equal($('#occult-glyph-level').val(), '2');
    equal($('#occult-glyph-rating').html(), '+783');
    equal($('#occult-glyph-ilvl').html(), '322');
    equal($('#occult-signet').val(), '1');
    equal($('#occult-signet-rarity').val(), 'superior');
    equal($('#occult-signet-level').val(), '10');
    equal($('#occult-signet-ilvl').html(), '22');
});

test('should set default values with an empty hash', 175, function() {
    location.hash = ''
    swlcalc.init();

    // Summary
    // --- Primary Stats
    equal($('#stat-ilvl').html(), '0');
    equal($('#stat-power-rating').html(), '0');
    equal($('#stat-weapon-power').html(), '0');
    equal($('#stat-attack-rating').html(), '4322');
    equal($('#stat-heal-rating').html(), '4310');
    equal($('#stat-hitpoints').html(), '7512');
    equal($('#stat-combat-power').html(), '324');
    equal($('#stat-healing-power').html(), '323');
    // --- Offensive Stats
    equal($('#stat-critical-rating').html(), '+756');
    equal($('#stat-critical-chance').html(), '13.3%');
    equal($('#stat-critical-power').html(), '+1008');
    equal($('#stat-critical-power-percentage').html(), '90.6%');
    equal($('#stat-hit-rating').html(), '+756');
    equal($('#stat-glance-reduction').html(), '14.9%');
    // --- Defensive Stats
    equal($('#stat-defense-rating').html(), '+753');
    equal($('#stat-glance-chance').html(), '7.4%');
    equal($('#stat-evade-rating').html(), '+753');
    equal($('#stat-evade-chance').html(), '5.2%');
    // equal($('#stat-physical-protection').html(), '+660');
    // equal($('#stat-magical-protection').html(), '+300');

    ok($('#weapon-slot').is(':visible'));
    equal($('#weapon-total-ilvl').html(), '0');
    equal($('#weapon-name').html(), '');
    equal($('#weapon-wtype').val(), 'none');
    equal($('#weapon-rarity').val(), 'standard');
    equal($('#weapon-quality').val(), 'mkI');
    equal($('#weapon-level').val(), '20');
    equal($('#weapon-power-rating').html(), '0');
    equal($('#weapon-ilvl').html(), '0');
    equal($('#weapon-glyph').val(), 'none');
    equal($('#weapon-glyph-rarity').val(), 'standard');
    equal($('#weapon-glyph-quality').val(), 'crude');
    equal($('#weapon-glyph-level').val(), '20');
    equal($('#weapon-glyph-rating').html(), '0');
    equal($('#weapon-glyph-ilvl').html(), '0');
    equal($('#weapon-signet').val(), 'none');
    equal($('#weapon-signet-rarity').val(), undefined);
    equal($('#weapon-signet-level').val(), undefined);
    equal($('#weapon-signet-ilvl').html(), undefined);

    ok(!$('#weapon2-slot').is(':visible'));
    equal($('#weapon2-total-ilvl').html(), '0');
    equal($('#weapon2-name').html(), '');
    equal($('#weapon2-wtype').val(), 'none');
    equal($('#weapon2-rarity').val(), 'standard');
    equal($('#weapon2-quality').val(), 'mkI');
    equal($('#weapon2-level').val(), '20');
    equal($('#weapon2-power-rating').html(), '0');
    equal($('#weapon2-ilvl').html(), '0');
    equal($('#weapon2-glyph').val(), 'none');
    equal($('#weapon2-glyph-rarity').val(), 'standard');
    equal($('#weapon2-glyph-quality').val(), 'crude');
    equal($('#weapon2-glyph-level').val(), '20');
    equal($('#weapon2-glyph-rating').html(), '0');
    equal($('#weapon2-glyph-ilvl').html(), '0');
    equal($('#weapon2-signet').val(), 'none');
    equal($('#weapon2-signet-rarity').val(), undefined);
    equal($('#weapon2-signet-level').val(), undefined);
    equal($('#weapon2-signet-ilvl').html(), undefined);

    equal($('#head-total-ilvl').html(), '0');
    equal($('#head-itemId').val(), 'none');
    equal($('#head-rarity').val(), 'standard');
    equal($('#head-quality').val(), 'faded');
    equal($('#head-level').val(), '20');
    equal($('#head-power-rating').html(), '0');
    equal($('#head-ilvl').html(), '0');
    equal($('#head-glyph').val(), 'none');
    equal($('#head-glyph-rarity').val(), 'standard');
    equal($('#head-glyph-quality').val(), 'crude');
    equal($('#head-glyph-level').val(), '20');
    equal($('#head-glyph-rating').html(), '0');
    equal($('#head-glyph-ilvl').html(), '0');
    equal($('#head-signet').val(), 'none');
    equal($('#head-signet-rarity').val(), 'standard');
    equal($('#head-signet-level').val(), '20');
    equal($('#head-signet-ilvl').html(), '0');

    equal($('#finger-total-ilvl').html(), '0');
    equal($('#finger-itemId').val(), 'none');
    equal($('#finger-rarity').val(), 'standard');
    equal($('#finger-quality').val(), 'faded');
    equal($('#finger-level').val(), '20');
    equal($('#finger-power-rating').html(), '0');
    equal($('#finger-ilvl').html(), '0');
    equal($('#finger-glyph').val(), 'none');
    equal($('#finger-glyph-rarity').val(), 'standard');
    equal($('#finger-glyph-quality').val(), 'crude');
    equal($('#finger-glyph-level').val(), '20');
    equal($('#finger-glyph-rating').html(), '0');
    equal($('#finger-glyph-ilvl').html(), '0');
    equal($('#finger-signet').val(), 'none');
    equal($('#finger-signet-rarity').val(), 'standard');
    equal($('#finger-signet-level').val(), '20');
    equal($('#finger-signet-ilvl').html(), '0');

    equal($('#neck-total-ilvl').html(), '0');
    equal($('#neck-itemId').val(), 'none');
    equal($('#neck-rarity').val(), 'standard');
    equal($('#neck-quality').val(), 'faded');
    equal($('#neck-level').val(), '20');
    equal($('#neck-power-rating').html(), '0');
    equal($('#neck-ilvl').html(), '0');
    equal($('#neck-glyph').val(), 'none');
    equal($('#neck-glyph-rarity').val(), 'standard');
    equal($('#neck-glyph-quality').val(), 'crude');
    equal($('#neck-glyph-level').val(), '20');
    equal($('#neck-glyph-rating').html(), '0');
    equal($('#neck-glyph-ilvl').html(), '0');
    equal($('#neck-signet').val(), 'none');
    equal($('#neck-signet-rarity').val(), 'standard');
    equal($('#neck-signet-level').val(), '20');
    equal($('#neck-signet-ilvl').html(), '0');

    equal($('#wrist-total-ilvl').html(), '0');
    equal($('#wrist-itemId').val(), 'none');
    equal($('#wrist-rarity').val(), 'standard');
    equal($('#wrist-quality').val(), 'faded');
    equal($('#wrist-level').val(), '20');
    equal($('#wrist-power-rating').html(), '0');
    equal($('#wrist-ilvl').html(), '0');
    equal($('#wrist-glyph').val(), 'none');
    equal($('#wrist-glyph-rarity').val(), 'standard');
    equal($('#wrist-glyph-quality').val(), 'crude');
    equal($('#wrist-glyph-level').val(), '20');
    equal($('#wrist-glyph-rating').html(), '0');
    equal($('#wrist-glyph-ilvl').html(), '0');
    equal($('#wrist-signet').val(), 'none');
    equal($('#wrist-signet-rarity').val(), 'standard');
    equal($('#wrist-signet-level').val(), '20');
    equal($('#wrist-signet-ilvl').html(), '0');

    equal($('#luck-total-ilvl').html(), '0');
    equal($('#luck-itemId').val(), 'none');
    equal($('#luck-rarity').val(), 'standard');
    equal($('#luck-quality').val(), 'faded');
    equal($('#luck-level').val(), '20');
    equal($('#luck-power-rating').html(), '0');
    equal($('#luck-ilvl').html(), '0');
    equal($('#luck-glyph').val(), 'none');
    equal($('#luck-glyph-rarity').val(), 'standard');
    equal($('#luck-glyph-quality').val(), 'crude');
    equal($('#luck-glyph-level').val(), '20');
    equal($('#luck-glyph-rating').html(), '0');
    equal($('#luck-glyph-ilvl').html(), '0');
    equal($('#luck-signet').val(), 'none');
    equal($('#luck-signet-rarity').val(), 'standard');
    equal($('#luck-signet-level').val(), '20');
    equal($('#luck-signet-ilvl').html(), '0');

    equal($('#waist-total-ilvl').html(), '0');
    equal($('#waist-itemId').val(), 'none');
    equal($('#waist-rarity').val(), 'standard');
    equal($('#waist-quality').val(), 'faded');
    equal($('#waist-level').val(), '20');
    equal($('#waist-power-rating').html(), '0');
    equal($('#waist-ilvl').html(), '0');
    equal($('#waist-glyph').val(), 'none');
    equal($('#waist-glyph-rarity').val(), 'standard');
    equal($('#waist-glyph-quality').val(), 'crude');
    equal($('#waist-glyph-level').val(), '20');
    equal($('#waist-glyph-rating').html(), '0');
    equal($('#waist-glyph-ilvl').html(), '0');
    equal($('#waist-signet').val(), 'none');
    equal($('#waist-signet-rarity').val(), 'standard');
    equal($('#waist-signet-level').val(), '20');
    equal($('#waist-signet-ilvl').html(), '0');

    equal($('#occult-total-ilvl').html(), '0');
    equal($('#occult-itemId').val(), 'none');
    equal($('#occult-rarity').val(), 'standard');
    equal($('#occult-quality').val(), 'faded');
    equal($('#occult-level').val(), '20');
    equal($('#occult-power-rating').html(), '0');
    equal($('#occult-ilvl').html(), '0');
    equal($('#occult-glyph').val(), 'none');
    equal($('#occult-glyph-rarity').val(), 'standard');
    equal($('#occult-glyph-quality').val(), 'crude');
    equal($('#occult-glyph-level').val(), '20');
    equal($('#occult-glyph-rating').html(), '0');
    equal($('#occult-glyph-ilvl').html(), '0');
    equal($('#occult-signet').val(), 'none');
    equal($('#occult-signet-rarity').val(), 'standard');
    equal($('#occult-signet-level').val(), '20');
    equal($('#occult-signet-ilvl').html(), '0');
});
