/*! swlcalc version 1.5.2 2019-05-09 */

!function(){function t(t,e){return t.write('<div class="row"><div class="col-lg-5">\x3c!-- [ Set rarity v ] --\x3e<div class="btn-group setter"><a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#">Set rarity <span class="caret"></span></a><ul class="dropdown-menu button-bar-dropdown"><li><a id="btn-all-standard"><span class="fix-link">All to <span class="color-standard">Standard</span></span></a></li><li><a id="btn-all-superior"><span class="fix-link">All to <span class="color-superior">Superior</span></span></a></li><li><a id="btn-all-epic"><span class="fix-link">All to <span class="color-epic">Epic</span></span></a></li><li><a id="btn-all-mythic" ><span class="fix-link">All to <span class="color-mythic">Mythic</span></span></a></li><li><a id="btn-all-legendary"><span class="fix-link">All to <span class="color-legendary">Legendary</span></span></a></li></ul></div>\x3c!-- [ Set quality v ] --\x3e<div class="btn-group setter"><a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#">Set quality <span class="caret"></span></a><ul class="dropdown-menu button-bar-dropdown"><li><a id="btn-all-1-pip"><span class="fix-link">All to 1 pip</span></a></li><li><a id="btn-all-2-pip"><span class="fix-link">All to 2 pips</span></a></li><li><a id="btn-all-3-pip"><span class="fix-link">All to 3 pips</span></a></li></ul></div>\x3c!-- [ Set level v ] --\x3e<div class="btn-group setter"><a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#">Set level <span class="caret"></span></a><ul class="dropdown-menu button-bar-dropdown"><li><a id="btn-all-lvl-min"><span class="fix-link">All to min</span></a></li><li><a id="btn-all-lvl-max"><span class="fix-link">All to max</span></a></li></ul></div></div><div class="col-lg-4 anima-allocation-span">\x3c!-- Anima allocation [ 100% DPS |V] --\x3e<div class="btn-group anima-allocation-div"><p class="anima-allocation-label">Anima allocation :</p><select id="select-anima-allocation" class="anima-allocation-select color-dps"><option value="dps" class="color-dps" selected="true">100% Damage</option><option value="heal" class="color-heal">100% Healing</option><option value="tank" class="color-tank">100% Survivability</option></select></div></div><div class="col-lg-3">\x3c!-- [ Reset ][ Export ]--\x3e<div class="btn-group"><button id="btn-reset" class="btn btn-danger">Reset</button><a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">Export <span class="caret"></span></a><ul class="dropdown-menu"><li><a class="export" href="#open-export-modal" data="url" data-toggle="modal">URL</a></li></ul></div>\x3c!-- Pop-up window on [ Export ] --\x3e<div id="open-export-modal" class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Export</h4></div><div class="modal-body"><p>Copy this and share :</p><input id="export-text" type="text" class="form-control"></input></div></div></div></div></div></div>')}dust.register("buttonbar",t)}(),function(){function t(t,e){return t.write('<div class="masthead"><div class="row"><div class="col-lg-9 div-logo"><img class="logo-swlcalc" src="assets/images/logos/swlcalc.png" /><span class="logo-slogan mediumgrey">A gear planner for </span><img class="logo-swl" src="assets/images/logos/swl.png"/></div><div class="col-lg-3"><a class="btn btn-info" href="https://github.com/AntoineThebaud/swlcalc" target="_blank" style="color: white;">Github</a><a class="btn btn-default" href="https://forums.funcom.com/t/swlcalc-gear-planner-for-swl/1908" target="_blank">forum post</a></div></div></div><hr><div class="row"><div class="col-lg-12">').partial("buttonbar",e,null).write('</div></div><hr/><div class="row"><div class="col-lg-9">').partial("slots",e,null).write('</div><div class="col-lg-3">').partial("summary",e,null).write('</div></div><hr><div class="footer"><p>swlcalc &copy; 2017-2019 Antoine THEBAUD. Version <a href="https://github.com/AntoineThebaud/swlcalc/tree/1.5.2" target="_new">1.5.2</a>. Hosted on Github Pages.</p></div>')}dust.register("container",t)}(),function(){function t(t,e){return t.write('<select id="').reference(e.get("id_prefix"),e,"h").write("-").reference(e.get("id_suffix"),e,"h").write('-level" title="Please select level"><option value="20">20</option><option value="19">19</option><option value="18">18</option><option value="17">17</option><option value="16">16</option><option value="15">15</option><option value="14">14</option><option value="13">13</option><option value="12">12</option><option value="11">11</option><option value="10">10</option><option value="9">9</option><option value="8">8</option><option value="7">7</option><option value="6">6</option><option value="5">5</option><option value="4">4</option><option value="3">3</option><option value="2">2</option><option value="1">1</option></select>')}dust.register("levelselect",t)}(),function(){function t(t,e){return t.write('<select id="').reference(e.get("id_prefix"),e,"h").write("-").reference(e.get("id_suffix"),e,"h").write('-quality" title="Please select quality"><option value="1">').reference(e.get("pip1_name"),e,"h").write('</option><option value="2">').reference(e.get("pip2_name"),e,"h").write('</option><option value="3">').reference(e.get("pip3_name"),e,"h").write("</option></select>")}dust.register("qualityselect",t)}(),function(){function t(t,e){return t.write('<select id="').reference(e.get("id_prefix"),e,"h").write("-").reference(e.get("id_suffix"),e,"h").write('-rarity" title="Please select rarity"><option value="standard" class="color-standard">Standard</option><option value="superior" class="color-superior">Superior</option><option value="epic" class="color-epic">Epic</option><option value="mythic" class="color-mythic">Mythic</option><option value="legendary" class="color-legendary">Legendary</option></select>')}dust.register("rarityselect",t)}(),function(){function t(t,e){return t.section(e.get("slots"),e,{else:i,block:a},null)}function i(t,e){return t.write("<p>No slots found (Bug)!</p>")}function a(t,e){return t.write('<div id="').reference(e.get("id_prefix"),e,"h").write('-slot" class="slot"><table class="table-title"><tr><td class="td-title"><span><h4 class="slot">').reference(e.get("name"),e,"h").write('</h4><h4 id="').reference(e.get("id_prefix"),e,"h").write('-equipment-name" class="slot-name"></h4><span id="').reference(e.get("id_prefix"),e,"h").write('-name-warning" class="label label-important"><a class="slot-warning" href="#" data-toggle="tooltip"><i class="icon-warning-sign icon-white"></i></a></span></span></td>').exists(e.get("is_weapon"),e,{block:l},null).write('<td class="slot-ilvl lightgrey">Item Power : <span id="').reference(e.get("id_prefix"),e,"h").write('-ilvl">0</span></td></tr></table><table class="table table-slots"><tr>').exists(e.get("is_weapon"),e,{else:n,block:s},null).write('<td class="upgrade-label rarity swlcalclabel"><strong>Rarity :</strong></td><td class="upgrade-select rarity swlcalcselect">').partial("rarityselect",e,{id_suffix:"equipment"}).write('</td><td class="stat-value stat-inSlot"><span id="').reference(e.get("id_prefix"),e,"h").write('-equipment-power-rating">0</span>').exists(e.get("is_weapon"),e,{else:r,block:o},null).write('</td></tr><tr class="with-icon"><td class="equipment-img"><img id="').reference(e.get("id_prefix"),e,"h").write('-equipment-img-quality" class="item-icon equipment quality" src="assets/images/icons/quality/1.png"/><img id="').reference(e.get("id_prefix"),e,"h").write('-equipment-img-rarity" class="item-icon equipment rarity" src=""/><img id="').reference(e.get("id_prefix"),e,"h").write('-equipment-img-icon" class="item-icon equipment item" src="" alt="image"/><div id="').reference(e.get("id_prefix"),e,"h").write('-equipment-label-level" class="label-level big border-standard">20</div></td><td class="equipment-select">').exists(e.get("is_weapon"),e,{else:c,block:p},null).write('</td><td class="upgrade-label quality-label"><strong>Quality :</strong></td><td class="upgrade-select quality-select">').exists(e.get("is_weapon"),e,{else:u,block:h},null).write('</td><td rowspan="2" class="item-description"><span id="').reference(e.get("id_prefix"),e,"h").write('-equipment-description"></span></td></tr><tr><td rowspan="2" class="filler"></td><td rowspan="2" class="filler"></td><td rowspan="2" class="upgrade-label level-label"><strong>Level :</strong></td><td rowspan="2" class="upgrade-select level-select"><input id="').reference(e.get("id_prefix"),e,"h").write('-equipment-level" type="range" min="1" max="20" value="20" class="level-slider"></td></tr><tr><td class="ilvl lightgrey"><span id="').reference(e.get("id_prefix"),e,"h").write('-equipment-ilvl">0</span></td></tr></table><table id="').reference(e.get("id_prefix"),e,"h").write('-glyphs" class="table table-slots"><tr><td class="item-title lightgrey" colspan="2">Glyph</td><td class="upgrade-label rarity swlcalclabel"><strong>Rarity :</strong></td><td class="upgrade-select rarity swlcalcselect">').partial("rarityselect",e,{id_suffix:"glyph"}).write('</td><td class="filler"></td></tr><tr class="with-icon"><td class="glyph-img"><a href="#" class="glyph-tooltip" data-toggle="tooltip" title="Glyph for the ').reference(e.get("name"),e,"h").write(' slot. Choose which rarity, quality, level and stats it will have in your build."><img id="').reference(e.get("id_prefix"),e,"h").write('-glyph-img-quality" class="item-icon glyph quality" src="assets/images/icons/quality/1.png"/><img id="').reference(e.get("id_prefix"),e,"h").write('-glyph-img-rarity" class="item-icon glyph rarity" src="assets/images/icons/rarity/none-42x42.png"/><img id="').reference(e.get("id_prefix"),e,"h").write('-glyph-img-icon" class="item-icon glyph item" src="assets/images/icons/glyph/none.png" alt="Glyph"/><div id="').reference(e.get("id_prefix"),e,"h").write('-glyph-label-level" class="label-level little border-standard">20</div></a></td><td class="glyph-select"><select id="').reference(e.get("id_prefix"),e,"h").write('-glyph-id" title="Please select stat"><option value="none" selected="true">None</option><option value="hit-rating">Accurate</option><option value="critical-rating">Fierce</option><option value="critical-power">Devastating</option><option value="evade-rating">Elusive</option><option value="defense-rating">Stalwart</option></select></td><td class="upgrade-label quality-label"><strong>Quality :</strong></td><td class="upgrade-select quality-select">').partial("qualityselect",e,{id_suffix:"glyph",pip1_name:"Crude",pip2_name:"Simple",pip3_name:"Intricate"}).write('</td><td class="stat-value stat-inSlot"><span id="').reference(e.get("id_prefix"),e,"h").write('-glyph-rating">0</span><span id="').reference(e.get("id_prefix"),e,"h").write('-glyph-label"></span></td></tr><tr><td class="filler"></td><td class="filler"></td><td class="upgrade-label level-label"><strong>Level :</strong></td><td class="upgrade-select level-select"><input id="').reference(e.get("id_prefix"),e,"h").write('-glyph-level" type="range" min="1" max="20" value="20" class="level-slider"></td><td class="ilvl lightgrey"><span id="').reference(e.get("id_prefix"),e,"h").write('-glyph-ilvl">0</span></td></tr></table><table id="').reference(e.get("id_prefix"),e,"h").write('-signets" class="table table-slots">').exists(e.get("is_weapon"),e,{else:d,block:g},null).write("</table></div>")}function l(t,e){return t.write('<td class="td-swap"><a id="').reference(e.get("id_prefix"),e,"h").write('-swap-weapon" class="btn btn-success swap-weapon">Swap weapon</a></td>')}function n(t,e){return t.write('<td class="item-title lightgrey" colspan="2">Talisman</td>')}function s(t,e){return t.write('<td class="item-title lightgrey" colspan="2">Weapon</td>')}function r(t,e){return t.write("<span> Power Rating</span>")}function o(t,e){return t.write("<span> Weapon Power</span>")}function c(t,e){return t.write('<select id="').reference(e.get("id_prefix"),e,"h").write('-equipment-id" title="Please select talisman"></select>')}function p(t,e){return t.write('<select id="').reference(e.get("id_prefix"),e,"h").write('-equipment-id" title="Please select weapon"></select>')}function u(t,e){return t.partial("qualityselect",e,{id_suffix:"equipment",pip1_name:"Faded",pip2_name:"Luminous",pip3_name:"Radiant"})}function h(t,e){return t.partial("qualityselect",e,{id_suffix:"equipment",pip1_name:"MK I",pip2_name:"MK II",pip3_name:"MK III"})}function d(t,e){return t.write('<tr><td class="item-title lightgrey" colspan="2">Signet</td><td class="upgrade-label rarity swlcalclabel"><strong>Rarity :</strong></td><td class="upgrade-select rarity swlcalcselect">').partial("rarityselect",e,{id_suffix:"signet"}).write('</td><td id="').reference(e.get("id_prefix"),e,"h").write('-signet-description" class="item-description"></td></tr><tr class="with-icon"><td class="signet-img"><a href="#" class="signet-tooltip" data-toggle="tooltip" title="Signet for the ').reference(e.get("name"),e,"h").write(' slot. Choose the rarity and type of signet."><img id="').reference(e.get("id_prefix"),e,"h").write('-signet-img-rarity" class="item-icon signet rarity" src="assets/images/icons/rarity/none-42x42.png"/><img id="').reference(e.get("id_prefix"),e,"h").write('-signet-img-icon" class="item-icon signet item" src="assets/images/icons/signet/none.png" alt="Signet"/><div id="').reference(e.get("id_prefix"),e,"h").write('-signet-label-level" class="label-level little border-standard">20</div></a></td><td class="signet-select"><select id="').reference(e.get("id_prefix"),e,"h").write('-signet-id" title="Please select signet"></select></td><td class="upgrade-label quality-label"> \x3c!-- class is "quality.." instead of "level.." because we skip quality select for signets --\x3e<strong>Level :</strong></td><td class="upgrade-select quality-select"> \x3c!-- class is "quality.." instead of "level.." because we skip quality select for signets --\x3e<input id="').reference(e.get("id_prefix"),e,"h").write('-signet-level" type="range" min="1" max="20" value="20" class="level-slider"></td><td class="ilvl lightgrey"><span id="').reference(e.get("id_prefix"),e,"h").write('-signet-ilvl">0</span></td></tr>')}function g(t,e){return t.write('<tr><td class="item-title lightgrey" colspan="2">Suffix</td><td id="').reference(e.get("id_prefix"),e,"h").write('-signet-description" class="item-description" colspan="3" rowspan="2"></td><tr><td class="signet-select" colspan="2"><select id="').reference(e.get("id_prefix"),e,"h").write('-signet-id" title="Please select signet"></select></td></tr>')}dust.register("slots",t)}(),function(){function t(t,e){return t.write('<div id="summary"><div id="table-primary"><h4>Gear stats</h4><table class="table table-stats"><thead><th>Primary Stats</th><th>Value</th></thead><tbody><tr><td class="stat-name">Item Power</td><td id="stat-ilvl" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Power Rating</td><td id="stat-power-rating" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Weapon Power</td><td id="stat-weapon-power" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Attack Rating</td><td id="stat-attack-rating" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Heal Rating</td><td id="stat-heal-rating" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Hitpoints</td><td id="stat-hitpoints" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Combat Power</td><td id="stat-combat-power" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Healing Power</td><td id="stat-healing-power" class="stat-value stat-inSummary">0</td></tr></tbody></table></div><div id="table-offensive"><table class="table table-stats"><thead><th>Offensive Stats</th><th>Value</th></thead><tbody><tr><td class="stat-name">Critical Rating</td><td id="stat-critical-rating" class="stat-value stat-inSummary">0 %</td></tr><tr><td class="stat-name">Critical Chance %</td><td id="stat-critical-chance" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Critical Power Rating</td><td id="stat-critical-power" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Critical Power %</td><td id="stat-critical-power-percentage" class="stat-value stat-inSummary">0 %</td></tr><tr><td class="stat-name">Hit Rating</td><td id="stat-hit-rating" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Glance Reduction %</td><td id="stat-glance-reduction" class="stat-value stat-inSummary">0%</td></tr></tbody></table></div><div id="table-defensive"><table class="table table-stats"><thead><th>Defensive Stats</th><th>Value</th></thead><tbody><tr><td class="stat-name">Defense Rating</td><td id="stat-defense-rating" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Glance Chance %</td><td id="stat-glance-chance" class="stat-value stat-inSummary">0%</td></tr><tr><td class="stat-name">Evade Rating</td><td id="stat-evade-rating" class="stat-value stat-inSummary">0</td></tr><tr><td class="stat-name">Evade Chance %</td><td id="stat-evade-chance" class="stat-value stat-inSummary">0%</td></tr>\x3c!--below stats are not functionnal yet--\x3e<tr><td class="stat-name not-functionnal">Physical Protection</td><td id="stat-physical-protection" class="not-functionnal stat-value stat-inSummary">249</td></tr><tr><td class="stat-name not-functionnal">Magical Protection</td><td id="stat-magical-protection" class="not-functionnal stat-value stat-inSummary">249</td></tr></tbody></table></div></div>')}dust.register("summary",t)}(),$(document).ready(function(){swlcalc.init()});var swlcalc=swlcalc||{};(swlcalc=(swlcalc=function(){var t=function(){$("#btn-reset").trigger("click")},e=function(){$(".equipment-tooltip, .glyph-tooltip, .signet-tooltip").tooltip({placement:"left"}),$("#table-primary > label").tooltip({placement:"left"})},i=function(t){dust.render("container",{slots:swlcalc.data.template_data.slots,signets:swlcalc.data.signets},function(t,e){t&&console.log(t),$(".container").html(e)})},a=function(){var t=$.getUrlVars();return!$.isEmptyObject(t)&&9==Object.keys(t).length&&(swlcalc.import.start(t),!0)},l=function(){swlcalc.gear.init();for(var t=0;t<swlcalc.data.template_data.slots.length;t++)n(swlcalc.data.template_data.slots[t]);swlcalc.button.init(),swlcalc.buttonBar.init(),swlcalc.summary.init(),swlcalc.export.init()},n=function(t){swlcalc.select[t.id_prefix]=new swlcalc.select.SelectHandler(t),swlcalc.select[t.id_prefix].init()};return{init:function(){i(swlcalc.data.template_data),l(),a()||t(),e(),$("#summary").scrollToFixed()}}}())||{}).summary=function(){var a="dps",t=function(t){window.location.hash=swlcalc.export.createExportUrl()},e=function(){var t,e,i=l();for(var a in i)i.hasOwnProperty(a)&&(e=i[t=a],$("#stat-"+t).text(e))},l=function(){var t={"combat-power":0,"healing-power":0,"weapon-power":0,hitpoints:7512,"attack-rating":4322,"heal-rating":4310,"power-rating":0,ilvl:0};for(var e in swlcalc.gear.slots){var i=swlcalc.gear.slots[e];t.ilvl+=i.iLvl(),i.isWeapon()&&!i.weaponDrawn||(i.isWeapon()&&"none"!=i.equipmentId()?t["weapon-power"]=i.equipmentPowerRating():i.isWeapon()||"none"==i.equipmentId()||(t["power-rating"]+=i.equipmentPowerRating()))}if("dps"==a)t["attack-rating"]+=t["power-rating"];else if("heal"==a)t["heal-rating"]+=t["power-rating"];else if("tank"==a){t.hitpoints+=Math.round(1.427675*t["power-rating"])}return t["combat-power"]=n(t["attack-rating"],t["weapon-power"]),t["healing-power"]=s(t["heal-rating"],t["weapon-power"]),t.ilvl=d(t.ilvl),t},n=function(t,e){return Math.round((t+e)/(13+1/3))},s=function(t,e){return Math.round((t+e)/(13+1/3))},i=function(){var t=r();g(t)},r=function(){var t={"critical-rating":756,"critical-chance":1,"critical-power":1008,"critical-power-percentage":25,"hit-rating":756,"glance-reduction":0,"defense-rating":753,"glance-chance":0,"evade-rating":753,"evade-chance":0};for(var e in swlcalc.gear.slots){var i=swlcalc.gear.slots[e];i.isWeapon()&&!i.weaponDrawn||(t[i.glyphId()]+=i.glyphRating())}return t["critical-chance"]+=o(t["critical-rating"]),t["critical-power-percentage"]+=c(t["critical-power"]),t["glance-reduction"]=h(t["hit-rating"]),t["glance-chance"]=u(t["defense-rating"]),t["evade-chance"]=p(t["evade-rating"]),t["critical-rating"]=t["critical-rating"].toFixed(0),t["critical-chance"]=t["critical-chance"].toFixed(1),t["critical-power"]=t["critical-power"].toFixed(0),t["critical-power-percentage"]=t["critical-power-percentage"].toFixed(1),t["evade-chance"]=t["evade-chance"].toFixed(1),t},o=function(t){return t<6536?7.5+swlcalc.util.precisionRound(t/157.49,1):7.5+swlcalc.util.precisionRound(6536/157.49+(t-6536)/683,1)},c=function(t){return t<3258?30+swlcalc.util.precisionRound(t/28.31,1):30+swlcalc.util.precisionRound(3258/28.31+(t-3258)/136,1)},p=function(t){return t<4221?swlcalc.util.precisionRound(t/145.55,1):swlcalc.util.precisionRound(4221/145.55+(t-4221)/977.4,1)},u=function(t){return t<4221?swlcalc.util.precisionRound(t/101.71,1):swlcalc.util.precisionRound(4221/101.71+(t-4221)/683,1)},h=function(t){return swlcalc.util.precisionRound(t/50.85,1)},d=function(t){return Math.round(t/9)},g=function(t){for(var e in t)t.hasOwnProperty(e)&&(0<t[e]?$("#stat-"+e).html(m(e)?t[e].toString()+"%":"+"+t[e]):$("#stat-"+e).html(m(e)?"0%":"0"))},m=function(t){return"critical-power-percentage"==t||"critical-chance"==t||"glance-reduction"==t||"evade-chance"==t||"glance-chance"==t},y=function(){for(var t in swlcalc.gear.slots)swlcalc.gear.slots[t].updateEquipmentBonuses(v(),f()),swlcalc.gear.slots[t].updateSignetBonus(v(),f())},v=function(){return parseInt($("#stat-combat-power").text())},f=function(){return parseInt($("#stat-healing-power").text())};return{init:function(){},calculateCriticalChance:o,calculateCriticalPowerPercentage:c,calculateEvadeChance:p,calculateCombatPower:n,collectPrimaryStats:l,collectOffensiveDefensiveStats:r,collectAllStats:function(){return{primary:l(),offensive_defensive:r()}},updateAllStats:function(){e(),i(),y(),t()},updateDescriptions:y,setAnimaAllocation:function(t){a=t,this.updateAllStats()}}}(),(swlcalc=swlcalc||{}).select=swlcalc.select||{},swlcalc.select.SelectHandler=function(e){var i=swlcalc.gear.slots[e.id_prefix];this.init=function(){this.bindEvents(),this.addSignetsToSelect(),this.addItemsToSelect()},this.bindEvents=function(){i.el.equipmentId.change(this.handleEquipmentItemChange),i.el.equipmentRarity.change(this.handleEquipmentRarityChange),i.el.equipmentQuality.change(this.handleEquipmentQualityChange),i.el.equipmentLevel.change(this.handleEquipmentLevelChange),i.el.glyphId.change(this.handleGlyphChange),i.el.glyphRarity.change(this.handleGlyphRarityChange),i.el.glyphQuality.change(this.handleGlyphQualityChange),i.el.glyphLevel.change(this.handleGlyphLevelChange),"weapon"==e.kind?i.el.signetId.change(this.handleSuffixChange):(i.el.signetId.change(this.handleSignetChange),i.el.signetRarity.change(this.handleSignetRarityChange),i.el.signetLevel.change(this.handleSignetLevelChange))},this.addItemsToSelect=function(){var t=swlcalc.data.equipments.slot[e.kind].slice();i.el.equipmentId.append($("<option>",{value:"none",text:"None",selected:"true"})),"weapon"==e.group?(t.sort(function(t,e){return swlcalc.util.sortAsc(t.type+t.name.toLowerCase(),e.type+e.name.toLowerCase())}),t.forEach(function(t){i.el.equipmentId.append($("<option>",{value:t.id,text:"["+t.type+"] "+t.name}))})):(t.sort(function(t,e){return swlcalc.util.sortAsc(t.name.toLowerCase(),e.name.toLowerCase())}),t.forEach(function(t){i.el.equipmentId.append($("<option>",{value:t.id,text:t.name}))}))},this.addSignetsToSelect=function(){i.el.signetId.append($("<option>",{value:"none",text:"None",selected:"true"})),this.updateToDefaultSignet();var t=swlcalc.data.signets.slot[e.kind].slice();t.sort(function(t,e){return swlcalc.util.sortAsc(t.name.toLowerCase(),e.name.toLowerCase())}),$.each(t,function(t,e){i.el.signetId.append($("<option>",{value:e.id,text:e.name}))})};var a=function(t){$(t).attr("class","color-"+t.value)};this.updateToDefaultSignet=function(){$("#"+e.id_prefix+"-signet-img-icon").attr("src","assets/images/icons/signet/none.png"),$("#"+e.id_prefix+"-signet-img-rarity").attr("src","assets/images/icons/rarity/none-42x42.png")},this.handleEquipmentItemChange=function(t){i.updateEquipment(),i.updateEquipmentPowerRating(),i.updateEquipmentILvl(),swlcalc.summary.updateAllStats()},this.handleEquipmentRarityChange=function(t){a(this),i.updateEquipmentImgRarity(),i.updateEquipmentLevel(),i.updateEquipmentPowerRating(),i.updateEquipmentILvl(),swlcalc.summary.updateAllStats()},this.handleEquipmentQualityChange=function(t){i.updateEquipmentPowerRating(),i.updateEquipmentImgQuality(),swlcalc.summary.updateAllStats()},this.handleEquipmentLevelChange=function(t){i.updateEquipmentILvl(),i.updateEquipmentPowerRating(),i.updateEquipmentLabelLevelText(),swlcalc.summary.updateAllStats()},this.handleGlyphChange=function(t){i.updateGlyphImgIcon(),i.updateGlyphRating(),i.updateGlyphLabel(),i.updateGlyphILvl(),swlcalc.summary.updateAllStats()},this.handleGlyphRarityChange=function(t){a(this),i.updateGlyphQuality(),i.updateGlyphImgRarity(),i.updateGlyphLabelLevelColor(),i.updateGlyphILvl(),i.updateGlyphRating(),swlcalc.summary.updateAllStats()},this.handleGlyphQualityChange=function(t){i.updateGlyphRating(),i.updateGlyphImgQuality(),swlcalc.summary.updateAllStats()},this.handleGlyphLevelChange=function(t){i.updateGlyphRating(),i.updateGlyphILvl(),i.updateGlyphLabelLevelText(),swlcalc.summary.updateAllStats()},this.handleSuffixChange=function(t){i.updateSignet(),swlcalc.summary.updateAllStats()},this.handleSignetChange=function(t){i.updateSignet(),i.updateSignetILvl(),swlcalc.summary.updateAllStats()},this.handleSignetRarityChange=function(t){a(this),i.updateSignetImgIcon(),i.updateSignetImgRarity(),i.updateSignetLabelLevelColor(),i.updateSignetILvl(),swlcalc.summary.updateAllStats()},this.handleSignetLevelChange=function(t){i.updateSignetILvl(),i.updateSignetLabelLevelText(),swlcalc.summary.updateAllStats()}},(swlcalc=swlcalc||{}).button=function(){var e={},t=function(t){e[t]=new swlcalc.button.SwapWeaponButton(t),e[t].init()};return{init:function(){t("weapon"),t("weapon2")}}}(),swlcalc.button.SwapWeaponButton=function(e){var i=this;this.init=function(){this.bindEvents()},this.bindEvents=function(){$("#"+e+"-swap-weapon").on("click",this.weaponSwap)},this.weaponSwap=function(t){swlcalc.gear.slots[e].sheathWeapon(),swlcalc.gear.slots[i.otherWeapon()].drawWeapon(),swlcalc.summary.updateAllStats()},this.otherWeapon=function(){return"weapon"==e?"weapon2":"weapon"}},(swlcalc=swlcalc||{}).buttonBar=function(){var t={},e=function(){t.select_anima_allocation.on("change",i),t.btn_all_standard.on("click",a),t.btn_all_superior.on("click",a),t.btn_all_epic.on("click",a),t.btn_all_mythic.on("click",a),t.btn_all_legendary.on("click",a),t.btn_all_1_pip.on("click",l),t.btn_all_2_pip.on("click",l),t.btn_all_3_pip.on("click",l),t.btn_all_lvl_min.on("click",n),t.btn_all_lvl_max.on("click",n),t.btn_reset.on("click",s)},i=function(t){$(this).attr("class","anima-allocation-select color-"+this.value),swlcalc.summary.setAnimaAllocation(t.target.value)},a=function(t){var e=t.currentTarget.id.split("-")[2];for(var i in swlcalc.gear.slots){var a=swlcalc.gear.slots[i];a.equipmentRarity(e),a.el.equipmentRarity.change(),a.glyphRarity(e),a.el.glyphRarity.change(),a.signetRarity(e),a.el.signetRarity.change()}swlcalc.summary.updateAllStats()},l=function(t){var e=t.currentTarget.id.split("-")[2];for(var i in swlcalc.gear.slots){var a=swlcalc.gear.slots[i];a.equipmentQuality(e),a.el.equipmentQuality.change(),a.glyphQuality(e),a.el.glyphQuality.change()}swlcalc.summary.updateAllStats()},n=function(t){var e=t.currentTarget.id.split("-")[3];for(var i in swlcalc.gear.slots){var a=swlcalc.gear.slots[i];a.equipmentLevel(a.getAttrFromEquipmentLevel(e)),a.el.equipmentLevel.change(),a.glyphLevel(a.getAttrFromGlyphLevel(e)),a.el.glyphLevel.change(),a.signetLevel(a.getAttrFromSignetLevel(e)),a.el.signetLevel.change()}swlcalc.summary.updateAllStats()},s=function(t){swlcalc.gear.reset(),swlcalc.summary.updateAllStats()};return{el:t,init:function(){t={select_anima_allocation:$("#select-anima-allocation"),btn_all_standard:$("#btn-all-standard"),btn_all_superior:$("#btn-all-superior"),btn_all_epic:$("#btn-all-epic"),btn_all_mythic:$("#btn-all-mythic"),btn_all_legendary:$("#btn-all-legendary"),btn_all_1_pip:$("#btn-all-1-pip"),btn_all_2_pip:$("#btn-all-2-pip"),btn_all_3_pip:$("#btn-all-3-pip"),btn_all_lvl_min:$("#btn-all-lvl-min"),btn_all_lvl_max:$("#btn-all-lvl-max"),btn_reset:$("#btn-reset")},e()},setRarityOnAllSlots:a,resetGear:s}}(),(swlcalc=swlcalc||{}).export=function(){var e={},t=function(){e.export_btn.on("click",function(t){i()}),e.open_export_modal.on("shown.bs.modal",function(){e.export_text.focus()}),e.export_text.focus(function(){$(this).select(),$(this).mouseup(function(){return $(this).unbind("mouseup"),!1})})},i=function(){var t=a();e.export_text.val(location.origin+location.pathname+"#"+t)},a=function(){var t="",e=0;for(var i in swlcalc.gear.slots){var a=swlcalc.gear.slots[i];t+=l(a,a.mappedState()),e<swlcalc.gear.nbSlots()-1&&(t+="&"),e++}return t},l=function(t,e){var i=t.id+"="+e.equipment_rarity+","+e.equipment_id+","+e.equipment_quality+","+e.equipment_level+","+e.glyph_rarity+","+e.glyph_id+","+e.glyph_quality+","+e.glyph_level;return i+=","+e.signet_rarity+","+e.signet_id+","+e.signet_level};return{init:function(){e={export_btn:$("a.export"),export_text:$("#export-text"),open_export_modal:$("#open-export-modal")},t()},createSlotUrl:l,createExportUrl:a,startExportUrl:i}}(),(swlcalc=swlcalc||{}).import=function(){var i=function(t,e){var i=swlcalc.gear.slots[t];i.equipmentRarity(swlcalc.data.rarity_mapping.to_name[e[0]]),i.el.equipmentRarity.change(),i.equipmentId("0"==e[1]?"none":e[1]),i.el.equipmentId.change(),i.isWeapon(),i.equipmentQuality(e[2]),i.el.equipmentQuality.change(),i.equipmentLevel(e[3]),i.el.equipmentLevel.change(),i.glyphRarity(swlcalc.data.rarity_mapping.to_name[e[4]]),i.el.glyphRarity.change(),i.glyphId(swlcalc.data.glyph_stat_mapping.to_stat[e[5]]),i.el.glyphId.change(),i.glyphQuality(e[6]),i.el.glyphQuality.change(),i.glyphLevel(e[7]),i.el.glyphLevel.change(),void 0!==e[8]&&void 0!==e[9]&&"999"!==e[9]&&void 0!==e[10]&&(i.signetRarity(swlcalc.data.rarity_mapping.to_name[e[8]]),i.signetId("0"!=e[9]?e[9]:"none"),i.signetLevel(e[10]),i.el.signetId.change(),i.el.signetRarity.change())};return{start:function(t){for(var e in t)t.hasOwnProperty(e)&&(splitVars=t[e].split(","),i(e,splitVars));swlcalc.summary.updateAllStats()}}}(),(swlcalc=swlcalc||{}).util={capitalise:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},blankIfNone:function(t){return"None"==t||"none"==t?"":t},precisionRound:function(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i},sortAsc:function(t,e){return e<t?1:-1}},Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,i=Object(this),a=i.length>>>0,l=arguments[1],n=0;n<a;n++)if(e=i[n],t.call(l,e,n,i))return e}),(swlcalc=swlcalc||{}).gear=function(){var i=function(){swlcalc.gear.slots.weapon2.sheathWeapon(),swlcalc.gear.slots.weapon.weaponDrawn=!0};return{slots:{},init:function(){for(var t=0;t<swlcalc.data.template_data.slots.length;t++){var e=swlcalc.data.template_data.slots[t];this.slots[e.id_prefix]=new swlcalc.gear.Slot(e),this.slots[e.id_prefix].el.nameWarning.hide()}i()},nbSlots:function(){return Object.keys(this.slots).length},reset:function(){for(var t in this.slots)this.slots[t].reset()},state:function(){var t={};for(var e in this.slots)t[e]=this.slots[e].state();return t},mappedState:function(){var t={};for(var e in this.slots)t[e]=this.slots[e].mappedState();return t}}}(),swlcalc.gear.Slot=function(t){var a=this;this.id=t.id_prefix,this.name=t.name,this.kind=t.kind,this.type=t.type,this.group=t.group,this.weaponDrawn=!1,this.rawILvl=0,this.rawGlyphILvl=0,this.rawSignetILvl=0,this.el={div:$("#"+this.id+"-slot"),iLvl:$("#"+this.id+"-ilvl"),equipmentId:$("#"+this.id+"-equipment-id"),equipmentName:$("#"+this.id+"-equipment-name"),equipmentRarity:$("#"+this.id+"-equipment-rarity"),equipmentQuality:$("#"+this.id+"-equipment-quality"),equipmentLevel:$("#"+this.id+"-equipment-level"),equipmentPowerRating:$("#"+this.id+"-equipment-power-rating"),equipmentILvl:$("#"+this.id+"-equipment-ilvl"),equipmentImgIcon:$("#"+this.id+"-equipment-img-icon"),equipmentImgRarity:$("#"+this.id+"-equipment-img-rarity"),equipmentImgQuality:$("#"+this.id+"-equipment-img-quality"),equipmentLabelLevel:$("#"+this.id+"-equipment-label-level"),equipmentDescription:$("#"+this.id+"-equipment-description"),glyphId:$("#"+this.id+"-glyph-id"),glyphRarity:$("#"+this.id+"-glyph-rarity"),glyphQuality:$("#"+this.id+"-glyph-quality"),glyphLevel:$("#"+this.id+"-glyph-level"),glyphRating:$("#"+this.id+"-glyph-rating"),glyphLabel:$("#"+this.id+"-glyph-label"),glyphImgIcon:$("#"+this.id+"-glyph-img-icon"),glyphImgRarity:$("#"+this.id+"-glyph-img-rarity"),glyphImgQuality:$("#"+this.id+"-glyph-img-quality"),glyphLabelLevel:$("#"+this.id+"-glyph-label-level"),glyphILvl:$("#"+this.id+"-glyph-ilvl"),signetId:$("#"+this.id+"-signet-id"),signetRarity:$("#"+this.id+"-signet-rarity"),signetLevel:$("#"+this.id+"-signet-level"),signetImgIcon:$("#"+this.id+"-signet-img-icon"),signetImgRarity:$("#"+this.id+"-signet-img-rarity"),signetDescription:$("#"+this.id+"-signet-description"),signetLabelLevel:$("#"+this.id+"-signet-label-level"),signetILvl:$("#"+this.id+"-signet-ilvl"),nameWarning:$("#"+this.id+"-name-warning")},this.iLvl=function(){if(1!=arguments.length)return parseInt(this.el.iLvl.html());this.el.iLvl.html(arguments[0])},this.updateILvl=function(){this.iLvl(Math.round(this.rawILvl+this.rawGlyphILvl+this.rawSignetILvl))},this.equipmentName=function(){if(1!=arguments.length)return this.el.equipmentName.html();this.el.equipmentName.html(arguments[0])},this.isWeapon=function(){return"weapon"==this.group},this.sheathWeapon=function(){this.isWeapon()&&(this.weaponDrawn=!1,this.el.div.hide())},this.drawWeapon=function(){this.isWeapon()&&(this.weaponDrawn=!0,this.el.div.show())},this.equipmentId=function(){if(1!=arguments.length)return this.el.equipmentId.val();this.el.equipmentId.val(arguments[0])},this.equipmentData=function(){return swlcalc.data.equipments.slot[this.kind][this.equipmentId()-1]},this.equipmentRarity=function(){if(1!=arguments.length)return this.el.equipmentRarity.val();this.el.equipmentRarity.val(arguments[0])},this.equipmentQuality=function(){if(1!=arguments.length)return this.el.equipmentQuality.val();this.el.equipmentQuality.val(arguments[0])},this.equipmentLevel=function(){if(1!=arguments.length)return this.el.equipmentLevel.val();this.el.equipmentLevel.val(arguments[0])},this.getAttrFromEquipmentLevel=function(t){return this.el.equipmentLevel.attr(t)},this.equipmentPowerRating=function(){if(1!=arguments.length)return parseInt(this.el.equipmentPowerRating.html());this.el.equipmentPowerRating.html(arguments[0])},this.equipmentILvl=function(){if(1!=arguments.length)return parseInt(this.el.equipmentILvl.html());this.el.equipmentILvl.html(arguments[0])},this.equipmentDescription=function(){if(1!=arguments.length)return this.el.equipmentDescription.text();this.el.equipmentDescription.html(arguments[0])},this.equipmentBonusN=function(){if(2==arguments.length)$("#"+this.id+"-equipment-bonus"+arguments[0]).html(arguments[1]);else{if(1==arguments.length)return $("#"+this.id+"-equipment-bonus"+arguments[0]).html();console.log("Error on this.equipmentBonusN() call")}},this.equipmentImgIcon=function(){if(1!=arguments.length)return this.el.equipmentImgIcon.attr("src");this.el.equipmentImgIcon.attr("src",arguments[0])},this.equipmentImgRarity=function(){if(1!=arguments.length)return this.el.equipmentImgRarity.attr("src");this.el.equipmentImgRarity.attr("src",arguments[0])},this.equipmentImgQuality=function(){if(1!=arguments.length)return this.el.equipmentImgQuality.attr("src");this.el.equipmentImgQuality.attr("src",arguments[0])},this.equipmentLabelLevel=function(){if(1!=arguments.length)return this.el.equipmentLabelLevel.text();this.el.equipmentLabelLevel.html(arguments[0])},this.updateEquipment=function(){var t;if("none"==this.equipmentId())this.equipmentImgIcon("assets/images/icons/"+this.type+"/None.png"),t="";else{var e=this.equipmentData(),i=new Image;i.onload=function(){a.equipmentImgIcon("assets/images/icons/"+a.type+"/"+e.name+".png")},i.onerror=function(){a.isWeapon()?a.equipmentImgIcon("assets/images/icons/"+a.type+"/temp/"+e.type+".png"):a.equipmentImgIcon("assets/images/icons/"+a.type+"/"+swlcalc.data.equipments.slot[a.id][0].name+".png")},i.src="assets/images/icons/"+this.type+"/"+e.name+".png",t=e.description,this.isWeapon()&&(t=t.replace(/%id/g,this.id))}this.equipmentDescription(t)},this.updateEquipmentLevel=function(){var t=swlcalc.data.rarity_mapping.to_max_level[this.equipmentRarity()];this.el.equipmentLevel.attr("max",t),this.equipmentLevel(t),this.updateEquipmentLabelLevelText(),this.updateEquipmentLabelLevelColor()},this.updateEquipmentPowerRating=function(){var t=0,e=0;"none"!=this.equipmentId()&&(e=this.isWeapon()?(t=swlcalc.data.power_rating.weapon[this.equipmentRarity()].weapon_power_init,swlcalc.data.power_rating.weapon[this.equipmentRarity()].weapon_power_per_level*(this.equipmentLevel()-1)):(t=swlcalc.data.power_rating[this.group][this.equipmentRarity()][this.equipmentQuality()].power_rating_init,swlcalc.data.power_rating[this.group][this.equipmentRarity()][this.equipmentQuality()].power_rating_per_level*(this.equipmentLevel()-1)));var i=t+Math.round(e);0!==i&&(i="+"+i),this.equipmentPowerRating(i)},this.updateEquipmentILvl=function(){var t=0;"none"!=this.equipmentId()&&(t=this.computeItemILvl("equipment",this.equipmentRarity(),this.equipmentLevel()),this.isWeapon()&&(t*=1.15)),this.rawILvl=t,this.equipmentILvl(Math.round(t)),this.updateILvl()},this.updateEquipmentBonuses=function(t,e){if(void 0!==this.equipmentBonusN(1)){var a=this.equipmentData(),l=0;for(i=0;i<a.coefficients.length;i++)"Combat Power"==a.stats[i]?l=t:"Healing Power"==a.stats[i]&&(l=e),this.equipmentBonusN(i+1,Math.round(a.coefficients[i]*l))}},this.updateEquipmentImgRarity=function(){var t="assets/images/icons/rarity/"+this.equipmentRarity()+"-42x42.png";this.equipmentImgRarity(t)},this.updateEquipmentImgQuality=function(){var t="assets/images/icons/quality/"+this.equipmentQuality()+".png";this.equipmentImgQuality(t)},this.updateEquipmentLabelLevelText=function(){this.equipmentLabelLevel(this.equipmentLevel())},this.updateEquipmentLabelLevelColor=function(){this.el.equipmentLabelLevel.attr("class","label-level big border-"+this.equipmentRarity())},this.glyphId=function(){if(1!=arguments.length)return this.el.glyphId.val();this.el.glyphId.val(arguments[0])},this.glyphRarity=function(){if(1!=arguments.length)return this.el.glyphRarity.val();this.el.glyphRarity.val(arguments[0])},this.glyphQuality=function(){if(1!=arguments.length)return this.el.glyphQuality.val();this.el.glyphQuality.val(arguments[0])},this.glyphLevel=function(){if(1!=arguments.length)return this.el.glyphLevel.val();this.el.glyphLevel.val(arguments[0])},this.getAttrFromGlyphLevel=function(t){return this.el.glyphLevel.attr(t)},this.glyphRating=function(){if(1!=arguments.length)return parseInt(this.el.glyphRating.html());this.el.glyphRating.html(arguments[0])},this.glyphLabel=function(){if(1!=arguments.length)return this.el.glyphLabel.html();this.el.glyphLabel.html(arguments[0])},this.glyphILvl=function(){if(1!=arguments.length)return parseInt(this.el.glyphILvl.html());this.el.glyphILvl.html(arguments[0])},this.glyphImgIcon=function(){if(1!=arguments.length)return this.el.glyphImgIcon.attr("src");this.el.glyphImgIcon.attr("src",arguments[0])},this.glyphImgRarity=function(){if(1!=arguments.length)return this.el.glyphImgRarity.attr("src");this.el.glyphImgRarity.attr("src",arguments[0])},this.glyphImgQuality=function(){if(1!=arguments.length)return this.el.glyphImgQuality.attr("src");this.el.glyphImgQuality.attr("src",arguments[0])},this.glyphLabelLevel=function(){if(1!=arguments.length)return this.el.glyphLabelLevel.text();this.el.glyphLabelLevel.html(arguments[0])},this.updateGlyphQuality=function(){var t=0<$("#"+this.id+"-glyph-quality option[value=4]").length;3<=swlcalc.data.rarity_mapping.to_num[this.glyphRarity()]&&!t?this.el.glyphQuality.append("<option value='4'>Elaborate</option>"):swlcalc.data.rarity_mapping.to_num[this.glyphRarity()]<3&&t&&($("#"+this.id+"-glyph-quality option[value=4]").remove(),this.updateGlyphImgQuality())},this.updateGlyphRating=function(){var t=0;if("none"!=this.glyphId()){var e=swlcalc.data.glyph[this.glyphRarity()][this.glyphQuality()].rating_init,i=swlcalc.data.glyph[this.glyphRarity()][this.glyphQuality()].rating_per_level*(this.glyphLevel()-1);t=e+Math.round(i),"critical-power"==this.glyphId()&&(t*=.973),0!==(t=t.toFixed(0))&&(t="+"+t)}this.glyphRating(t)},this.updateGlyphImgIcon=function(){var t="assets/images/icons/glyph/"+this.glyphId()+".png";this.glyphImgIcon(t)},this.updateGlyphImgRarity=function(){var t="assets/images/icons/rarity/"+this.glyphRarity()+"-42x42.png";this.glyphImgRarity(t)},this.updateGlyphImgQuality=function(){var t="assets/images/icons/quality/"+this.glyphQuality()+".png";this.glyphImgQuality(t)},this.updateGlyphILvl=function(){var t=0;"none"!=this.glyphId()&&(t=this.computeItemILvl("glyph",this.glyphRarity(),this.glyphLevel()),this.isWeapon()&&(t*=1.225)),this.rawGlyphILvl=t,this.glyphILvl(Math.round(t)),this.updateILvl()},this.updateGlyphLabel=function(){this.glyphLabel(" "+swlcalc.data.glyph_stat_mapping.to_stat_GUIformat[this.glyphId()])},this.updateGlyphLabelLevelText=function(){this.glyphLabelLevel(this.glyphLevel())},this.updateGlyphLabelLevelColor=function(){this.el.glyphLabelLevel.attr("class","label-level little border-"+this.glyphRarity())},this.signetData=function(){return"none"==this.signetId()||null==this.signetId()||null==this.signetId()?swlcalc.data.signets.noneSignet:swlcalc.data.signets.slot[this.kind][this.signetId()-1]},this.signetId=function(){if(1!=arguments.length)return this.el.signetId.val();this.el.signetId.val(arguments[0])},this.signetRarity=function(){if(1!=arguments.length)return this.el.signetRarity.val();this.el.signetRarity.val(arguments[0])},this.signetLevel=function(){if(1!=arguments.length)return this.el.signetLevel.val();this.el.signetLevel.val(arguments[0])},this.getAttrFromSignetLevel=function(t){return this.el.signetLevel.attr(t)},this.signetILvl=function(){if(1!=arguments.length)return this.isWeapon()?void 0:parseInt(this.el.signetILvl.html());this.el.signetILvl.html(arguments[0])},this.signetDescription=function(){if(1!=arguments.length)return this.el.signetDescription.text();this.el.signetDescription.html(arguments[0])},this.signetBonus=function(){if(1!=arguments.length)return $("#"+this.id+"signet-bonus").html();$("#"+this.id+"-signet-bonus").html(arguments[0])},this.signetImgIcon=function(){if(1!=arguments.length)return this.el.signetImgIcon.attr("src");this.el.signetImgIcon.attr("src",arguments[0])},this.signetImgRarity=function(){if(1!=arguments.length)return this.el.signetImgRarity.attr("src");this.el.signetImgRarity.attr("src",arguments[0])},this.signetLabelLevel=function(){if(1!=arguments.length)return this.el.signetLabelLevel.text();this.el.signetLabelLevel.html(arguments[0])},this.updateSignet=function(){this.updateSignetImgIcon(),this.updateSignetImgRarity();var t=this.signetData().description;this.isWeapon()&&(t=t.replace(/%id/g,this.id)),this.signetDescription(t),this.updateSignetBonus()},this.updateSignetImgIcon=function(){var t="assets/images/icons/signet/"+(this.signetData()==swlcalc.data.signets.noneSignet?"none":this.id)+".png";this.signetImgIcon(t)},this.updateSignetImgRarity=function(){var t="assets/images/icons/rarity/"+this.signetRarity()+"-42x42.png";this.signetImgRarity(t)},this.updateSignetDescription=function(){this.el.signetDescription.html(this.signetDescription())},this.updateSignetBonus=function(t,e){var i=0,a=1;if(0!=this.signetData().id){var l=swlcalc.data.signets.slot[this.kind][this.signetId()-1];if(this.isWeapon())i=l.quality[this.equipmentQuality()];else{if("Signet of Shoulder Tackle"==l.name)return bonus1=l.ratio[this.signetRarity()].init[0],bonus2=l.ratio[this.signetRarity()].init[1]-l.ratio[this.signetRarity()].per_level[1]*(this.signetLevel()-1),$("#"+this.id+"-signet-bonus").html(bonus1),void $("#"+this.id+"-signet-bonus2").html(swlcalc.util.precisionRound(bonus2,4));i="Signet of Contortion"==l.name?l.ratio[this.signetRarity()].init-l.ratio[this.signetRarity()].per_level*(this.signetLevel()-1):l.ratio[this.signetRarity()].init+l.ratio[this.signetRarity()].per_level*(this.signetLevel()-1)}null!=l.stat&&("Combat Power"==l.stat?a=t:"Healing Power"==l.stat&&(a=e))}i*=a,i=swlcalc.util.precisionRound(i,4),this.signetBonus(i)},this.updateSignetILvl=function(){var t=0;"none"!=this.signetId()&&(t=this.computeItemILvl("signet",this.signetRarity(),this.signetLevel())),this.rawSignetILvl=t,this.signetILvl(Math.round(t)),this.updateILvl()},this.updateSignetLabelLevelText=function(){this.signetLabelLevel(this.signetLevel())},this.updateSignetLabelLevelColor=function(){this.el.signetLabelLevel.attr("class","label-level little border-"+this.signetRarity())},this.reset=function(){this.el.equipmentId.prop("selectedIndex",0),this.el.equipmentRarity.prop("selectedIndex",0),this.el.equipmentQuality.prop("selectedIndex",0),this.el.glyphId.prop("selectedIndex",0),this.el.glyphRarity.prop("selectedIndex",0),this.el.glyphQuality.prop("selectedIndex",0),this.el.glyphLevel.val("20"),this.el.signetId.prop("selectedIndex",0),this.el.signetRarity.prop("selectedIndex",0),this.el.signetLevel.val("20"),this.el.equipmentId.change(),this.el.equipmentRarity.change(),this.el.equipmentQuality.change(),this.el.glyphId.change(),this.el.glyphRarity.change(),this.el.glyphQuality.change(),this.el.glyphLevel.change(),this.el.signetId.change(),this.el.signetRarity.change(),this.el.signetLevel.change(),this.updateSignet()},this.state=function(){return{equipment_rarity:this.equipmentRarity(),equipment_quality:this.equipmentQuality(),equipment_level:this.equipmentLevel(),glyph_id:this.glyphId(),glyph_rarity:this.glyphRarity(),glyph_quality:this.glyphQuality(),glyph_level:this.glyphLevel(),signet_id:this.signetId(),signet_rarity:this.signetRarity(),signet_level:this.signetLevel()}},this.mappedState=function(){var t=swlcalc.data.glyph_stat_mapping.to_num,e=swlcalc.data.rarity_mapping.to_num;return{equipment_id:this.stripContent(this.equipmentId()),equipment_rarity:this.stripContent(this.equipmentRarity(),e),equipment_quality:this.equipmentQuality(),equipment_level:this.equipmentLevel(),glyph_id:this.stripContent(this.glyphId(),t),glyph_rarity:this.stripContent(this.glyphRarity(),e),glyph_quality:this.glyphQuality(),glyph_level:this.glyphLevel(),signet_id:this.stripContent(this.signetId()),signet_rarity:this.stripContent(this.signetRarity(),e),signet_level:this.stripContent(this.signetLevel())}},this.stripContent=function(t,e){return null==t||"none"==t||void 0===t?0:void 0!==e?e[t]:t},this.computeItemILvl=function(t,e,i){var a=swlcalc.data.ilvl.gear[t].rarity[e];return a.ilvl_init+a.ilvl_per_level*(i-1)}};